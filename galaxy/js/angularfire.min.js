"use strict";function AngularFire(e,r,t,n){if(this._q=e,this._parse=r,this._timeout=t,this._initial=!0,this._remoteValue=!1,"string"==typeof n)throw new Error("Please provide a Firebase reference instead of a URL, eg: new Firebase(url)");this._fRef=n}angular.module("firebase",[]).value("Firebase",Firebase),angular.module("firebase").factory("angularFire",["$q","$parse","$timeout",function(e,r,t){return function(n,i,a){var o=new AngularFire(e,r,t,n);return o.associate(i,a)}}]),AngularFire.prototype={associate:function(e,r){var t=this,n=this._q.defer(),i=n.promise;return this._fRef.on("value",function(i){var a=i.val(),o=angular.fromJson(angular.toJson(t._parse(r)(e)));if(t._initial){t._initial=!1;var u=!1,s=Object.prototype.toString;if(a&&s.call(o)==s.call(a))if("[object Array]"==s.call(o))u=o.concat(a),angular.equals(u,a)||(t._fRef.ref().set(u),a=u);else if("[object Object]"==s.call(o)){u=o;for(var c in a)u[c]=a[c];t._fRef.ref().update(u),a=u}null===a&&(t._fRef.ref().set(o),a=o)}var l=!1;n&&(l=n,n=!1),t._timeout(function(){t._resolve(e,r,l,a)})}),i},disassociate:function(){var e=this;e._unregister&&e._unregister(),this._fRef.off("value")},_resolve:function(e,r,t,n){var i=this;if(null===n){var a=e[r];if("object"==typeof a){var o=Object.prototype.toString;n=o.call(a)==o.call([])?[]:{}}}this._remoteValue=angular.copy(n),this._parse(r).assign(e,angular.copy(n)),t&&(t.resolve(function(){i.disassociate()}),this._watch(e,r))},_watch:function(e,r){var t=this;t._unregister=e.$watch(r,function(){if(!t._initial){var n=angular.fromJson(angular.toJson(t._parse(r)(e)));if(!angular.equals(n,t._remoteValue)){var i=Object.prototype.toString;"[object Object]"==i.call(n)?t._fRef.set?t._fRef.set(n):t._fRef.ref().update(n):t._fRef.ref().set(n)}}},!0),e.$on("$destroy",function(){t.disassociate()})},_log:function(e){console&&console.log&&console.log(e)}},angular.module("firebase").factory("angularFireCollection",["$timeout",function(e){return function(r,t){function n(e,r){this.$ref=e.ref(),this.$id=e.name(),this.$index=r,angular.extend(this,{$priority:e.getPriority()},e.val())}function i(e){return e?f[e]+1:0}function a(e,r){f[r.$id]=e,h.splice(e,0,r)}function o(e){var r=f[e];h.splice(r,1),f[e]=void 0}function u(e,r){h[e]=r}function s(e,r,t){h.splice(e,1),h.splice(r,0,t),c(e,r)}function c(e,r){var t=h.length;r=r||t,r>t&&(r=t);for(var n=e;r>n;n++){var i=h[n];i.$index=f[i.$id]=n}}if("string"==typeof r)throw new Error("Please provide a Firebase reference instead of a URL, eg: new Firebase(url)");var l=[function(e){return null==e.$priority?0:angular.isNumber(e.$priority)?1:angular.isString(e.$priority)?2:void 0},function(e){return e.$priority?e.$priority:1/0},function(e){return e.$id}],f={},h=[];return t&&"function"==typeof t&&r.once("value",t),r.on("child_added",function(r,t){e(function(){var e=i(t);a(e,new n(r,e)),c(e)})}),r.on("child_removed",function(r){e(function(){var e=r.name(),t=f[e];o(e),c(t)})}),r.on("child_changed",function(r,t){e(function(){var e=f[r.name()],a=i(t),o=new n(r,e);u(e,o),a!==e&&s(e,a,o)})}),r.on("child_moved",function(r,t){e(function(){var e=f[r.name()],n=i(t),a=h[e];s(e,n,a)})}),h.getByName=function(e){return h[f[e]]},h.add=function(e,t){var n;return n=t?r.ref().push(e,t):r.ref().push(e)},h.remove=function(e,r){var t=angular.isString(e)?h[f[e]]:e;r?t.$ref.remove(r):t.$ref.remove()},h.update=function(e,r){var t=angular.isString(e)?h[f[e]]:e,n={};angular.forEach(t,function(e,r){0!==r.indexOf("$")&&(n[r]=e)}),r?t.$ref.set(n,r):t.$ref.set(n)},h.order=l,h}}]),angular.module("firebase").factory("angularFireAuth",["$rootScope","$parse","$timeout","$location","$route","$q",function(e,r,t,n,i,a){function o(e){var r=e.split(".");if(!r instanceof Array||3!==r.length)throw new Error("Invalid JWT");var t=r[1];return window.atob?JSON.parse(decodeURIComponent(escape(window.atob(t)))):e}function u(e,n,i,a){n&&t(function(){r(n).assign(e,i),a()})}function s(e,r,t){e.authRequired&&!t._authenticated&&(t._redirectTo=void 0===e.pathTo?n.path():e.pathTo===r?"/":e.pathTo,n.replace(),n.path(r))}return{initialize:function(r,t){var n=this;if("string"==typeof r)throw new Error("Please provide a Firebase reference instead of a URL, eg: new Firebase(url)");if(t=t||{},this._scope=e,!t.scope)throw new Error("Scope not provided to angularFireAuth!");if(this._scope=t.scope,!t.name)throw new Error("Model name not provided to angularFireAuth!");if(this._name=t.name,this._cb=function(){},t.callback&&"function"==typeof t.callback&&(this._cb=t.callback),this._redirectTo=null,this._authenticated=!1,t.path&&(i.current&&s(i.current,t.path,n),e.$on("$routeChangeStart",function(e,r){s(r,t.path,n)})),this._ref=r,t.simple===!1)return u(this._scope,this._name,null,function(){}),void 0;if(!window.FirebaseSimpleLogin){var a=new Error("FirebaseSimpleLogin undefined, did you include firebase-simple-login.js?");return e.$broadcast("angularFireAuth:error",a),void 0}var o=new FirebaseSimpleLogin(this._ref,function(r,t){n._cb(r,t),r?e.$broadcast("angularFireAuth:error",r):t?n._loggedIn(t):n._loggedOut()});this._authClient=o},login:function(r,t){var n=this._watchForLogin();switch(r){case"github":case"persona":case"twitter":case"facebook":case"password":if(this._authClient)this._authClient.login(r,t);else{var i=new Error("Simple Login not initialized");e.$broadcast("angularFireAuth:error",i)}break;default:var a,u=this;try{a=o(r),this._ref.auth(r,function(r){r?e.$broadcast("angularFireAuth:error",r):u._loggedIn(a)})}catch(s){e.$broadcast("angularFireAuth:error",s)}}return n},createUser:function(r,n,i,a){var o=this;this._authClient.createUser(r,n,function(u,s){try{u?e.$broadcast("angularFireAuth:error",u):a||o.login("password",{email:r,password:n})}catch(c){e.$broadcast("angularFireAuth:error",c)}i&&t(function(){i(u,s)})})},logout:function(){this._authClient?this._authClient.logout():(this._ref.unauth(),this._loggedOut())},_loggedIn:function(r){var t=this;this._authenticated=!0,u(this._scope,this._name,r,function(){e.$broadcast("angularFireAuth:login",r),t._redirectTo&&(n.replace(),n.path(t._redirectTo),t._redirectTo=null)})},_loggedOut:function(){this._authenticated=!1,u(this._scope,this._name,null,function(){e.$broadcast("angularFireAuth:logout")})},_watchForLogin:function(){function r(e,r){t(function(){e?i.reject(e):i.resolve(r)});for(var a=0;a<n.length;a++)n[a]()}var n=[],i=a.defer();return n.push(e.$on("angularFireAuth:login",function(e,t){r(null,t)})),n.push(e.$on("angularFireAuth:error",function(e,t){r(t,null)})),i.promise}}}]);