<h1 class="page-title txt-left">{{ page_title }}</h1>

<div class="container-fluid l-wrapper-page">

    <div class="row">
        <div class="col-lg-12">

            <ng-include src="'/static/partials/filterWidget.html'"></ng-include>

            <p class="search-filter__blank-slate" ng-show="noSearchResults()">No roles found</p>

            <table ng-show="hasSearchResults()" class="table">
                <thead>
                <tr>
                    <th>User</th>
                    <th>Roles</th>
                    <th>Latest Rating</th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="user in users">
                    <td class="user">
                        <a href="#/users/{{user.id}}"><img ng-src="{{user.avatar_url}}" /></a>
                        <div class="info">
                            <div><a class="username" href="#/users/{{user.id}}">{{ user.username }}</a>
                                <span class="name" ng-show="user.full_name">{{ user.full_name }}</span><br \>
                                <span ng-show="user.staff" class="staff-marker"><i class="fa fa-asterisk"></i> Ansible Staff</span>
                            </div>
                            <div class="score">
                                <span class="fld-label">Karma</span>
                                <span class="score-value-na" ng-show="user.karma <= 0">NA</span>
                                <span class="score-value" ng-show="user.karma > 0">{{user.karma}}</span>
                            </div>
                            <div class="date">
                                <span class="fld-label">Date Joined</span>
                                <span class="value">{{ user.date_joined | date:"short" }}</span>
                            </div>
                        </div>
                    </td>
                    <td>
                        <div ng-repeat="role in user.summary_fields.roles | limitTo:5">
                          <a class="role" href="#/roles/{{role.id}}">{{role.name}}</a>
                        </div>
                        <div ng-show="user.num_roles > 5"><a class="role" href="#/users/{{user.id}}">more...</a></div>
                        <div ng-show="user.num_roles == 0">This user has no roles</div>
                        <div class="scores-section">
                          <div class="scores">
                            <div class="score">

                              <span class="fld-label">Roles contributed</span>
                                {{ user.num_roles | number:0 }}
                            </div>
                            <div class="score">

                              <span class="score-value-na"
                                    ng-show="user.avg_role_score == '0.0'">
                                NA
                              </span>

                              <span class="score-value"
                                    ng-show="user.avg_role_score > 0">
                                <i ng-repeat="itm in user.avg_role_score_range" class="{{ itm.value }}"></i>
                              </span>

                              <span class="badge"
                                    ng-show="user.avg_role_score > 0 && avg_role_score_hover_{{ $index }}">
                                {{ user.avg_role_score | number:1 }}
                              </span>

                              <span class="fld-label">
                                Community Score (Avg)
                              </span>

                            </div>
                            <div class="score">
<span class="score-value-na" ng-show="user.avg_role_aw_score == '0.0'">NA</span>
                                    <span class="score-value" ng-show="user.avg_role_aw_score > 0"><i ng-repeat="itm in user.avg_role_aw_score_range" class="{{ itm.value }}"></i></span>
                                    <span class="badge" ng-show="user.avg_role_aw_score > 0 && avg_role_aw_score_hover_{{ $index }}">{{ user.avg_role_score | number:1 }}</span>
                                    <span class="fld-label">Ansible Score (Avg)</span>
                            </div>
                          </div>
                        </div>
                    </td>
                    <td ng-init="rating = user.summary_fields.ratings[0]">
                        <div>
                            <div class="text">{{ rating.comment }}</div>
                            <table class="inner-table" ng-show="user.summary_fields.ratings.length">
                                <tr ng-mouseenter="hover($index,'rating',true)" ng-mouseleave="hover($index,'rating',false)"
                                    ng-show="user.summary_fields.ratings.length">
                                    <td>Score</td>
                                    <td><i ng-repeat="itm in user.rating_range" class="{{ itm.value }}"></i>
                                        <span class="badge" ng-show="rating_hover_{{ $index }}">{{ rating.score | number:1 }}</span></td>
                                </tr>
                                <tr ng-mouseenter="hover($index,'avg_rating',true)" ng-mouseleave="hover($index,'avg_rating',false)">
                                    <td>Avg. Rating Given</td>
                                    <td><span class="score-value-na" ng-show="user.avg_rating == '0.0'">NA</span>
                                        <span class="score-value" ng-show="user.avg_rating > 0"><i ng-repeat="itm in user.avg_rating_range" class="{{ itm.value }}"></i></span>
                                        <span class="badge" ng-show="avg_rating_hover_{{ $index }}">{{ user.avg_rating | number:1 }}</span>
                                </tr>
                                <tr>
                                    <td>Added</td>
                                    <td>{{ rating.created|date:"short" }}</td>
                                </tr>
                                <tr ng-show="rating.created != rating.modified">
                                    <td>Last Modified</td>
                                    <td>{{rating.modified|date:"short"}}</td>
                                </tr>
                            </table>
                        </div>
                        <div ng-hide="user.summary_fields.ratings.length">No ratings found.</div>
                    </td>
                </tr>
               </tbody>
            </table>

            <ng-include src="'/static/partials/paginateWidget.html'"></ng-include>

        </div>
    </div>
</div>
